(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e703d3f2"],{"043a":function(t,e,n){"use strict";n("4ab1")},"0ccf":function(t,e,n){},"4ab1":function(t,e,n){},5534:function(t,e,n){"use strict";n("0ccf")},"69fb":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"boradWrap"},[t.board_modify.handle?[n("h1",[t._v("수정하기")]),n("div",{staticClass:"inputWrap"},[n("p",[t._v("제목")]),n("el-input",{attrs:{placeholder:"title",clearable:""},model:{value:t.board_modify.title,callback:function(e){t.$set(t.board_modify,"title",e)},expression:"board_modify.title"}})],1),n("div",{staticClass:"inputWrap"},[n("p",[t._v("내용")]),n("el-input",{attrs:{placeholder:"content",clearable:""},model:{value:t.board_modify.content,callback:function(e){t.$set(t.board_modify,"content",e)},expression:"board_modify.content"}})],1),n("div",{staticClass:"inputWrap"},[n("p",[t._v("기존 첨부파일 수정")]),n("ul",{staticClass:"fileListWrap"},t._l(this.board_modify.exist_attachment,(function(e,i){return n("li",{key:i,staticClass:"fileList"},[n("span",{on:{click:function(e){return t.deleteExistFileList(i)}}},[n("i",{staticClass:"el-icon-circle-close"})]),t._v(t._s(e.originalFileName))])})),0)]),n("div",{staticClass:"inputWrap"},[n("p",[t._v("첨부 파일 추가")]),n("el-button",{attrs:{"native-type":"button",round:"",icon:"el-icon-document-add",size:"mini"},on:{click:t.handleFileUpload}}),n("input",{ref:"file",attrs:{type:"file",id:"userImage",multiple:""},on:{change:t.previewImage}}),n("transition",{attrs:{name:"slide-fade"}},[t.board_modify.new_attachment.length?n("ul",{staticClass:"fileListWrap"},t._l(this.board_modify.new_attachment,(function(e,i){return n("li",{key:i,staticClass:"fileList"},[n("span",{on:{click:function(e){return t.deleteFileList(i)}}},[n("i",{staticClass:"el-icon-circle-close"})]),t._v(t._s(e.name)+" ")])})),0):t._e()])],1),n("div",{staticClass:"btnWrap"},[n("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.cancelModify()}}},[t._v("취소")]),n("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.updateBoard()}}},[t._v("저장")])],1)]:[n("div",{staticClass:"listWrap"},[n("el-button",{attrs:{icon:"el-icon-s-fold",size:"mini"},on:{click:function(e){return t.$router.push({name:"boardList"})}}},[t._v(" 목록 ")])],1),n("div",{staticClass:"titleWrap"},[n("h2",[t._v(t._s(t.board.title))])]),n("div",{staticClass:"contentWrap"},[n("p",[t._v(t._s(t.board.content))])]),t.board.attachment?n("div",{staticClass:"attachmentWrap"},t._l(t.board.attachment,(function(e){return n("el-button",{key:e._id,attrs:{type:"text",size:"mini",icon:"el-icon-folder"},on:{click:function(n){return t.fileDownload(e.serverFileName)}}},[t._v(t._s(e.originalFileName))])})),1):t._e(),t.current_user.email===t.board.uploadedBy.email?n("div",{staticClass:"btnWrap"},[n("el-button",{attrs:{size:"mini"},on:{click:function(e){t.board_modify.handle=!0}}},[t._v(" 수정 ")]),n("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.deleteBoard()}}},[t._v(" 삭제 ")])],1):t._e(),n("div",{staticClass:"line"}),n("Comment",{attrs:{comments:t.comments},on:{callFecthBoard:t.fecthBoard}})]],2)},a=[],o=n("2909"),s=n("1da1"),r=n("5530"),c=(n("159b"),n("99af"),n("a434"),n("96cf"),n("ab3f")),m=n("2f62"),l=n("dd61"),d=n.n(l),u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"commentsWrap"},[n("div",{staticClass:"commentWrite"},[n("el-input",{attrs:{size:"mini",maxlength:"55",placeholder:"댓글을 입력해주세요."},model:{value:t.comment_to_board_string,callback:function(e){t.comment_to_board_string=e},expression:"comment_to_board_string"}},[n("el-button",{attrs:{slot:"append",size:"mini",icon:"el-icon-chat-line-round"},on:{click:t.writeCommentToBoard},slot:"append"})],1)],1),n("div",{staticClass:"commentList"},t._l(t.comments,(function(e,i){return n("div",{key:i,staticClass:"row"},[n("div",{staticClass:"col"},[n("div",{staticClass:"imgWrap"},[e.uploadedBy.image?n("img",{attrs:{src:e.uploadedBy.image,alt:"프로필사진"}}):n("i",{staticClass:"el-icon-user"})])]),n("div",{staticClass:"col"},[n("div",{staticClass:"box"},[n("span",{staticClass:"author"},[t._v(t._s(e.uploadedBy.name))])]),n("div",{staticClass:"box"},[e.modify?[n("span",{staticClass:"content"},[n("el-input",{attrs:{size:"mini",maxlength:"55"},model:{value:t.comment_modify_string,callback:function(e){t.comment_modify_string=e},expression:"comment_modify_string"}})],1),n("span",[n("el-button",{attrs:{size:"mini",disabled:!t.comment_modify_string.length},on:{click:function(n){return t.updateComment(e._id)}}},[t._v("수정")])],1),n("span",[n("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.handleUpdateComment(i)}}},[t._v("취소")])],1)]:[n("span",{staticClass:"content"},[t._v(t._s(e.content))]),n("span",{staticClass:"time"},[t._v(t._s(t.diffTime(e.createdAt)))]),n("span",{staticClass:"more"},[n("el-popover",{attrs:{placement:"bottom",trigger:"click","visible-arrow":"true"}},[e.uploadedBy.email===t.current_user.email?n("div",{staticStyle:{"text-align":"right",margin:"0"}},[n("el-button",{attrs:{size:"mini"},on:{click:function(n){return t.handleUpdateComment(i,e.content)}}},[t._v("수정")]),n("el-button",{attrs:{size:"mini"},on:{click:function(n){return t.deleteComment(e._id)}}},[t._v("삭제")])],1):n("div",{staticStyle:{"text-align":"right",margin:"0"}},[n("el-button",{attrs:{size:"mini"}},[t._v("신고")])],1),n("el-button",{attrs:{slot:"reference",size:"mini",type:"text",icon:"el-icon-more"},slot:"reference"})],1)],1)]],2),n("div",{staticClass:"box"},[n("el-button",{staticClass:"like",attrs:{size:"mini",type:"text"}},[t._v("좋아요")]),n("el-button",{staticClass:"unLike",attrs:{size:"mini",type:"text"}},[t._v("싫어요")]),n("el-button",{staticClass:"reply",attrs:{size:"mini",type:"text"},on:{click:function(e){return t.handleReply(i)}}},[t._v("답글")])],1),e.reply?n("div",{staticClass:"box"},[n("el-input",{attrs:{size:"mini",maxlength:"55",placeholder:"댓글을 입력해주세요."},model:{value:t.comment_to_comment_string,callback:function(e){t.comment_to_comment_string=e},expression:"comment_to_comment_string"}},[n("el-button",{attrs:{slot:"append",size:"mini",icon:"el-icon-chat-line-round"},on:{click:function(n){return t.writeCommentToComment(e._id)}},slot:"append"})],1)],1):t._e(),e.comments.length?n("div",{staticClass:"box"},[n("el-button",{staticClass:"moreReply",attrs:{size:"mini",type:"text",icon:e.visible?"el-icon-caret-top":"el-icon-caret-bottom"},on:{click:function(e){return t.handleNestedCommentVisible(i)}}},[t._v("댓글 보기")])],1):t._e(),n("div",{staticClass:"box"},[n("transition",{attrs:{name:"slide-fade"}},[e.visible?[n("div",{staticClass:"commentList"},t._l(e.comments,(function(e,a){return n("div",{key:a,staticClass:"row"},[n("div",{staticClass:"col"},[n("div",{staticClass:"imgWrap"},[e.uploadedBy.image?n("img",{attrs:{src:e.uploadedBy.image,alt:"프로필사진"}}):n("i",{staticClass:"el-icon-user"})])]),n("div",{staticClass:"col"},[n("div",{staticClass:"box"},[n("span",{staticClass:"author"},[t._v(t._s(e.uploadedBy.name))])]),n("div",{staticClass:"box"},[e.modify?[n("span",{staticClass:"content"},[n("el-input",{attrs:{size:"mini",maxlength:"55"},model:{value:t.nested_comment_modify_string,callback:function(e){t.nested_comment_modify_string=e},expression:"nested_comment_modify_string"}})],1),n("span",[n("el-button",{attrs:{size:"mini",disabled:!t.nested_comment_modify_string.length},on:{click:function(n){return t.updateNestedComment(e._id)}}},[t._v("수정")])],1),n("span",[n("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.handleUpdateNestedComment(i,a)}}},[t._v("취소")])],1)]:[n("span",{staticClass:"content"},[t._v(t._s(e.content))]),n("span",{staticClass:"time"},[t._v(t._s(t.diffTime(e.createdAt)))]),n("span",{staticClass:"more"},[n("el-popover",{attrs:{placement:"bottom",trigger:"click","visible-arrow":"true"}},[e.uploadedBy.email===t.current_user.email?n("div",{staticStyle:{"text-align":"right",margin:"0"}},[n("el-button",{attrs:{size:"mini"},on:{click:function(n){return t.handleUpdateNestedComment(i,a,e.content)}}},[t._v("수정")]),n("el-button",{attrs:{size:"mini"},on:{click:function(n){return t.deleteComment(e._id)}}},[t._v("삭제")])],1):n("div",{staticStyle:{"text-align":"right",margin:"0"}},[n("el-button",{attrs:{size:"mini"}},[t._v("신고")])],1),n("el-button",{attrs:{slot:"reference",size:"mini",type:"text",icon:"el-icon-more"},slot:"reference"})],1)],1)]],2),n("div",{staticClass:"box"},[n("el-button",{staticClass:"like",attrs:{size:"mini",type:"text"}},[t._v("좋아요")]),n("el-button",{staticClass:"unLike",attrs:{size:"mini",type:"text"}},[t._v("싫어요")])],1)])])})),0)]:t._e()],2)],1)])])})),0)])},p=[],_=n("b775");function f(t){return _["a"].post("/comment/writeToBoard",t)}function h(t){return _["a"].post("/comment/writeToComment",t)}function b(t){return _["a"].patch("/comment/update",t)}function v(t){return _["a"].delete("/comment/delete",{data:t})}var g={props:{comments:Array},data:function(){return{comment_to_board_string:"",comment_to_comment_string:"",comment_modify_string:"",nested_comment_modify_string:"",nested_comment_visible:!1}},computed:Object(r["a"])({},Object(m["c"])("auth",["current_user"])),methods:{writeCommentToBoard:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,f({content:t.comment_to_board_string,board:t.$route.params.id});case 2:t.comment_to_board_string="",t.$emit("callFecthBoard");case 4:case"end":return e.stop()}}),e)})))()},writeCommentToComment:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,h({content:e.comment_to_comment_string,comments:t});case 2:e.comment_to_comment_string="",e.$emit("callFecthBoard");case 4:case"end":return n.stop()}}),n)})))()},deleteComment:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.visible=!1,n.next=3,v({_id:t});case 3:e.$emit("callFecthBoard");case 4:case"end":return n.stop()}}),n)})))()},updateComment:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,b({_id:t,content:e.comment_modify_string});case 2:e.$emit("callFecthBoard");case 3:case"end":return n.stop()}}),n)})))()},updateNestedComment:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,b({_id:t,content:e.nested_comment_modify_string});case 2:e.$emit("callFecthBoard");case 3:case"end":return n.stop()}}),n)})))()},handleUpdateComment:function(t,e){this.comment_modify_string=e||"";var n=this.comments[t];n.modify=!n.modify,this.comments.splice(t,1,n)},handleUpdateNestedComment:function(t,e,n){this.nested_comment_modify_string=n||"";var i=this.comments[t];i.comments[e].modify=!i.comments[e].modify,this.comments[t].comments.splice(e,1,i.comments[e])},handleReply:function(t){var e=this.comments[t];e.reply=!e.reply,this.comments.splice(t,1,e)},diffTime:function(t){var e=(new Date).getTime(),n=new Date(t).getTime(),i=e-n,a=i,o=Math.floor(a/1e3/24/60/60);a-=1e3*o*24*60*60;var s=Math.floor(a/1e3/60/60);a-=1e3*s*60*60;var r=Math.floor(a/1e3/60);a-=1e3*r*60;var c=Math.floor(a/1e3);return a-=1e3*c,o?"".concat(o,"일 전"):s?"".concat(s,"시간 전"):r?"".concat(r,"분 전"):c?"".concat(c,"초 전"):"0초 전"},handleNestedCommentVisible:function(t){var e=this.comments[t];e.visible=!e.visible,this.comments.splice(t,1,e)}}},y=g,C=(n("5534"),n("2877")),w=Object(C["a"])(y,u,p,!1,null,null,null),x=w.exports,k={components:{Comment:x},data:function(){return{board:{attachment:[],uploadedBy:{email:""}},comments:[],board_modify:{handle:!1,title:"",content:"",new_attachment:[],exist_attachment:[]},remove_attachment_list:[],visible:!1,replay_visible:!1}},computed:Object(r["a"])({},Object(m["c"])("auth",["current_user"])),methods:{fecthBoard:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.$store.dispatch("common/getLoading",!0),e.next=3,Object(c["c"])(t.$route.params.id);case 3:n=e.sent,i=n.data,t.board=i,t.board_modify={title:i.title,content:i.content,handle:!1,new_attachment:[],exist_attachment:i.attachment},t.comments=d()(t.board.comments,(function(t){return Object(r["a"])(Object(r["a"])({},t),{},{modify:!1,reply:!1,visible:!1,comments:d()(t.comments,(function(t){return Object(r["a"])(Object(r["a"])({},t),{},{modify:!1})}))})})),t.$store.dispatch("common/getLoading",!1);case 9:case"end":return e.stop()}}),e)})))()},deleteBoard:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c["a"])({id:t.$route.params.id,email:t.board.uploadedBy.email}).then((function(){t.$message({showClose:!0,message:"글이 삭제되었습니다.",tpye:"success"}),t.$router.push({name:"boardList"})})).catch((function(e){t.$message({showClose:!0,message:e.response.data.errors.message,tpye:"error"})}));case 2:case"end":return e.stop()}}),e)})))()},updateBoard:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.board_modify.new_attachment.length+t.board_modify.exist_attachment.length,console.log(n),!(n>3)){e.next=4;break}return e.abrupt("return",t.$message({type:"info",message:"첨부 파일은 최대 3개 까지만 가능합니다."}));case 4:return t.$store.dispatch("common/getLoading",!0),i=new FormData,i.append("_id",t.board._id),i.append("email",t.board.uploadedBy.email),i.append("title",t.board_modify.title),i.append("content",t.board_modify.content),t.board_modify.new_attachment.length&&t.board_modify.new_attachment.forEach((function(t){i.append("attachment",t)})),t.remove_attachment_list.length&&t.remove_attachment_list.forEach((function(t){return i.append("removeFileIds",t._id)})),e.prev=12,e.next=15,Object(c["f"])(i);case 15:return t.board_modify.handle=!1,e.next=18,t.fecthBoard();case 18:e.next=23;break;case 20:e.prev=20,e.t0=e["catch"](12),t.$message({type:"error",message:"실패했습니다."});case 23:return e.prev=23,t.$store.dispatch("common/getLoading",!1),e.finish(23);case 26:case"end":return e.stop()}}),e,null,[[12,20,23,26]])})))()},fileDownload:function(t){return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:window.open("http://localhost:3000/api/file/".concat(t));case 1:case"end":return e.stop()}}),e)})))()},uploadFile:function(t){this.file=t},cancelModify:function(){this.board_modify={title:this.board.title,content:this.board.content,handle:!1,new_attachment:[],exist_attachment:this.board.attachment},this.remove_attachment_list=[]},handleFileUpload:function(){this.$refs.file.click()},previewImage:function(t){var e=3,n=t.target.files.length+this.board_modify.new_attachment.length;if(e<n)return this.$message({type:"info",message:"첨부 파일 최대 개수는 3개 입니다.",showClose:!0});this.board_modify.new_attachment=[].concat(Object(o["a"])(this.board_modify.new_attachment),Object(o["a"])(t.target.files))},deleteFileList:function(t){this.board_modify.new_attachment.splice(t,1)},deleteExistFileList:function(t){this.board_modify.exist_attachment.splice(t,1),this.remove_attachment_list.push(this.board_modify.exist_attachment[0])}},mounted:function(){this.fecthBoard()}},z=k,B=(n("043a"),Object(C["a"])(z,i,a,!1,null,"365f8225",null));e["default"]=B.exports},a434:function(t,e,n){"use strict";var i=n("23e7"),a=n("23cb"),o=n("5926"),s=n("07fa"),r=n("7b0b"),c=n("65f0"),m=n("8418"),l=n("1dde"),d=l("splice"),u=Math.max,p=Math.min,_=9007199254740991,f="Maximum allowed length exceeded";i({target:"Array",proto:!0,forced:!d},{splice:function(t,e){var n,i,l,d,h,b,v=r(this),g=s(v),y=a(t,g),C=arguments.length;if(0===C?n=i=0:1===C?(n=0,i=g-y):(n=C-2,i=p(u(o(e),0),g-y)),g+n-i>_)throw TypeError(f);for(l=c(v,i),d=0;d<i;d++)h=y+d,h in v&&m(l,d,v[h]);if(l.length=i,n<i){for(d=y;d<g-i;d++)h=d+i,b=d+n,h in v?v[b]=v[h]:delete v[b];for(d=g;d>g-i+n;d--)delete v[d-1]}else if(n>i)for(d=g-i;d>y;d--)h=d+i-1,b=d+n-1,h in v?v[b]=v[h]:delete v[b];for(d=0;d<n;d++)v[d+y]=arguments[d+2];return v.length=g-i+n,l}})}}]);
//# sourceMappingURL=chunk-e703d3f2.f0df9c5a.js.map